---
description: Coding standards and best practices for Go (Golang) development
globs: ["**/*.go"]
---

# Go Code Conventions & Best Practices

You are a senior Go engineer. Follow these rules strictly to ensure the codebase remains idiomatic, performant, and maintainable.

## 1. Code Structure & Style
- **Avoid Else:** Prefer early returns and "happy path" coding on the left-hand side of the screen.
- **Short Variable Names:** Use short, descriptive names for small scopes (e.g., `r` for reader, `srv` for server). Use longer names only for global or package-level variables.
- **Group Imports:** Group imports into three blocks: standard library, third-party libraries, and internal project packages.
- **Receiver Names:** Use 1-3 letter abbreviations for method receivers (e.g., `func (s *Server) Run()`). Do not use `this` or `self`.

## 2. Error Handling
- **Check Errors Early:** Never ignore errors using `_`. Handle them immediately.
- **Wrap Errors:** Use `fmt.Errorf("context: %w", err)` to provide trace context when bubbling errors up.
- **Error Types:** Use `errors.Is` and `errors.As` for checking specific error types.

## 3. Concurrency (The Go Way)
- **Channels vs Mutex:** "Do not communicate by sharing memory; instead, share memory by communicating."
- **Goroutine Leaks:** Always ensure goroutines have a clear exit strategy (context cancellation or close channels).
- **Context Usage:** The first argument of functions performing I/O or long-running tasks must be `ctx context.Context`.

## 4. Interfaces & Types
- **Small Interfaces:** Keep interfaces small (usually 1-3 methods). `io.Reader` and `io.Writer` are the gold standard.
- **Accept Interfaces, Return Structs:** Functions should accept interfaces for flexibility but return concrete types for usability.
- **Zero Values:** Ensure types are useful in their "zero value" state whenever possible.

## 5. Performance & Safety
- **Slice Pre-allocation:** Use `make([]T, 0, length)` if the final size is known to avoid re-allocations.
- **Avoid Init:** Use explicit initialization functions rather than `init()` blocks unless absolutely necessary.
- **Pointer Usage:** Only use pointers if the struct is large or if you need to modify the receiver. For small, immutable data, pass by value.

Reference @SPEC.md for project intent and @ARCHITECTURE.md for folder structure.